{% extends 'base.html' %}
<script>
{% block jquery %}
var endpoint = 'api/monitoring/'
var endpointongoing = 'api/monitoring/Ongoing/'
var endpointcompleted = 'api/monitoring/Completed/'
var defaultData = []
var current_ongoing_data = []
var completed_item_data = []
var labels = [];
var ongoing_labels = []
var completed_labels = []

// Request Chart
$.ajax({
    method: "GET",
    url: endpoint,
    success: function(data){
        labels = data.labels
        defaultData = data.default
        setChart()
    },
    error: function(error_data){
        console.log("error")
        console.log(error_data)
    }
})

//Ongoing Chart
$.ajax({
    method: "GET",
    url: endpointongoing,
    success: function(ongoing_data){
        ongoing_labels = ongoing_data.ongoing_labels
        current_ongoing_data = ongoing_data.default_ongoing
        ongoing_chart()
    },
    error: function(error_data){
        console.log("error")
        console.log(error_data)
    }
})

//Completed Chart
$.ajax({
    method: "GET",
    url: endpointcompleted,
    success: function(completed_data){
        completed_item_data = completed_data.datacompleted
        setChart()
    },
    error: function(error_data){
        console.log("error")
        console.log(error_data)
    }
})

function setChart(){
    var ctx1 = document.getElementById("ongoing_data");
    var ctx2 = document.getElementById("myChart2");
    var ctx3 = document.getElementById("completed");
    var myChart = new Chart(ctx2, {
    type: 'pie',
    data: {
        labels: labels,
        datasets: [{
            label: '# Data',
            data: defaultData,
            backgroundColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
    });
    var completed_Data_list = new Chart(ctx3, {
      type: 'bar',
    data: {
        labels: ["FATA Monitoring",
        "Corrective Maintenance", "Customer Care", "Ownership", "TOO Billing", "Car Rental Request", "Gas Card Request", "Preventive Maintenance", "Insurance", "New Vehicle Payment", "Car Rental Payment"
        , "Fuel Supplier Payment", "Vehicle Repair Payment"],
        datasets: [{
            label: '#Data',
            data: completed_item_data,
            backgroundColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
    });

    var ongoing_chart = new Chart(ctx1, {
    type: 'horizontalBar',
    data: {
        labels: ["FATA Monitoring",
        "Corrective Maintenance", "Customer Care", "Ownership", "TOO Billing", "Car Rental Request", "Gas Card Request","Service Vehicle Request", "Preventive Maintenance", "Insurance", "New Vehicle Payment", "Car Rental Payment"
        , "Fuel Supplier Payment", "Vehicle Repair Payment"],
        datasets: [{
            label: '#Data',
            data: current_ongoing_data,
            backgroundColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderColor: [
                'rgba(255, 0, 0, 1)',
                'rgba(255, 255, 0, 1)',
                'rgba(136, 204, 0, 1)',
                'rgba(51, 153, 255, 1)',
                'rgba(204, 0, 204, 1)',
                'rgba(204, 102, 153, 1)',
                'rgba(0, 0, 153, 1, 1)',
                'rgba(0, 102, 153, 1)',
                'rgba(255, 204, 255)',
                'rgba(0, 153, 204, 1)',
                'rgba(51, 204, 51, 1)',
                'rgba(153, 153, 102, 1)',
                'rgba(34, 51, 0, 1, 1)',
                'rgba(102, 0, 102, 1)',
                'rgba(128, 0, 0,1)',
                'rgba(92, 24, 12, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
    });

    window.onload = function(){
        var ctx2 = document.getElementById("myChart2").getContext("2d");
        window.myBar = new Chart(ctx2).Bar(myChart, {
            responsive : true
        });
        var ctx3 = document.getElementById("completed").getContext("2d");
        window.myBar = new Chart(ctx3).Bar(completed_Data_list, {
            responsive : true
        });
        var ctx1 = document.getElementById("ongoing_data").getContext("2d");
        window.myBar = new Chart(ctx1).Bar(ongoing_chart, {
            responsive : true
        });
    }
    
}


{% endblock %}
</script>
{% block content %}
 <!-- Content Wrapper. Contains page content -->
    <!-- Content Header (Page header) -->
<!-- <div class="content-wrapper"> -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6 float-sm-right">
            <h1 class="m-0 float-sm-right">Dashboard</h1>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-info">
              <div class="inner">
                <h3 style="font-size: 20px">Total</h3>
                <h3 style="font-size: 20px">{{ count13 }}</h3>
                <h2 class="h5">Vehicle Masterlist</h2>
              </div>
              <div class="icon">
                <i class="fas fa-car"></i>
              </div>
              <a href="{% url 'vehicle-list' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
            </div>

          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-success">
              <div class="inner">
                <h3 style="font-size: 20px">Total</h3>
                <h3 style="font-size: 20px">{{ count12 }}</h3>
                <h2 class="h5">Employee Masterlist</h2>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
              <a href="{% url 'employee-list' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
            </div>
          </div>

          <!-- ./col -->
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-warning">
              <div class="inner">
                <h3 style="font-size: 20px">Total</h3>
                <h3 style="font-size: 20px">{{ count15 }}</h3>
                <h2 class="h5">Leasing Masterlist</h2>
              </div>
              <div class="icon">
                <i class="ion ion-stats-bars"></i>
              </div>
              <a href="{% url 'leasing_list' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
            </div>
          </div>
          <div class="col-lg-3 col-6">
            <!-- small box -->
            <div class="small-box bg-danger">
              <div class="inner">
                <h3 style="font-size: 20px">Total Pending</h3>
                <h3 style="font-size: 20px">{{ count16 }}</h3>
                <h2 class="h5">Customer Log's</h2>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
              <a href="{% url 'CS_List' %}" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
            </div>
          </div>
          <!-- ./col -->
          <!-- ./col -->
        </div>
        <!-- /.row -->
        <!-- Main row -->
        <div class="row">
          <!-- Left col -->
          <section class="col-lg-7 connectedSortable">
            <!-- Custom tabs (Charts with tabs)-->
            <div class="card ">
              <div class="card-header">
                <h3 class="card-title">
                  <i class="fas fa-chart-pie mr-1"></i>
                  Request For the Month of <u>{{month}}</u>
                </h3>
              </div><!-- /.card-header -->
              <div class="card-body">
                <div class="tab-content p-0">
                  <!-- Morris chart - Sales -->
                  <div class="chart tab-pane active" id="revenue-chart"
                       style="position: relative; height: 600px;">
                      <canvas id="myChart2" height="300" style="height: 400px;"></canvas>
                   </div>
                </div>
              </div><!-- /.card-body -->
            </div>
            
            <!-- /.card -->
            <!-- /.card -->
          </section>

          <!-- /.Left col -->
          <!-- right col (We are only adding the ID to make the widgets sortable)-->
          <section class="col-lg-5 connectedSortable">

            <!-- Map card -->
            <!-- /.card -->

            <!-- solid sales graph -->
            <div class="card bg-info.bg-gradient">
              <div class="card-header border-0">
                <h3 class="card-title">
                  <i class="fas fa-th mr-1"></i>
                  Ongoing For the Month of <u>{{month}}</u>
                </h3>

                <div class="card-tools">
                </div>
              </div>
              <div class="card-body "style="position: relative; height: 650px;">
                <canvas class="chart" id="ongoing_data" style="height: 600px; max-width: 100%;"></canvas>
              </div>
            </div>
            <!-- /.card -->
            <!-- /.card -->
          </section>
          <!-- right col -->
        </div>
        <!-- /.row (main row) -->
      </div><!-- /.container-fluid -->
        <div class="card ">
          <div class="card-header">
            <h3 class="card-title">
              <i class="fas fa-chart-pie mr-1"></i>
              Completed For the Month of <u>{{month}}</u>
            </h3>
          </div><!-- /.card-header -->
          <div class="card-body">
            <div class="tab-content p-0">
              <!-- Morris chart - Sales -->
              <div class="card-body">
                  <canvas id="completed" style="height: 500px; max-width: 100%;"></canvas>
               </div>
            </div>
          </div><!-- /.card-body -->
        </div>
    </section>

    <!-- /.content -->
<!-- </div> -->
  <!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
</div>
{% endblock %}


